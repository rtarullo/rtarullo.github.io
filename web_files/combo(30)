YUI.add("hermes-template-search-people-page",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression;return u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["global-nav-view"],u):a.call(t,"outlet",t["global-nav-view"],u)))+"\n\n",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["search-subnav-view"],u):a.call(t,"outlet",t["search-subnav-view"],u)))+"\n\n",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["search-people-results-view"],u):a.call(t,"outlet",t["search-people-results-view"],u)))+"\n\n",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["feedback-widget-view"],u):a.call(t,"outlet",t["feedback-widget-view"],u)))+"\n\n",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["footer-full-view"],u):a.call(t,"outlet",t["footer-full-view"],u)))+"\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-people-page",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-result-card",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){return" linked"}function h(e,t){return" reboot-restyle"}function p(e,t){var r="",i;return r+='\n		<div class="coverphoto-gradient"></div>\n		<div class="cover" style="background-image:url(',(i=n.coverPhotoUrl)?i=i.call(e,{hash:{},data:t}):(i=e.coverPhotoUrl,i=typeof i===a?i.apply(e):i),r+=f(i)+')"></div>\n	',r}function d(e,t){var n="",r;return n+='<a href="'+f((r=(r=e.avatar,r==null||r===!1?r:r.link),typeof r===a?r.apply(e):r))+'">',n}function v(e,t){var n="",r;return n+=' data-group-nsid="'+f((r=(r=e.avatar,r==null||r===!1?r:r.groupNsid),typeof r===a?r.apply(e):r))+'" ',n}function m(e,t){var n="",r;return n+=' data-person-nsid="'+f((r=(r=e.avatar,r==null||r===!1?r:r.personNsid),typeof r===a?r.apply(e):r))+'" ',n}function g(e,t){return"</a>"}function y(e,t){var r="",i;r+='\n				<div class="subtitle">\n					',i=n["if"].call(e,e.isPro,{hash:{},inverse:l.noop,fn:l.program(16,b,t),data:t});if(i||i===0)r+=i;r+="\n					",i=n.each.call(e,e.subtitles,{hash:{},inverse:l.noop,fn:l.program(18,w,t),data:t});if(i||i===0)r+=i;return r+="\n				</div>\n			",r}function b(e,t){return'<span class="pro-badge-inline">PRO</span>'}function w(e,t){var n="";return n+="<span>"+f(typeof e===a?e.apply(e):e)+"</span>",n}function E(e,t){var r="",i;r+="\n				",i=n["if"].call(e,e.subtitle,{hash:{},inverse:l.noop,fn:l.program(21,S,t),data:t});if(i||i===0)r+=i;return r+="\n			",r}function S(e,t){var r="",i;r+="\n					",i=n["if"].call(e,e.isPro,{hash:{},inverse:l.noop,fn:l.program(16,b,t),data:t});if(i||i===0)r+=i;return r+='\n					<div class="subtitle">',(i=n.subtitle)?i=i.call(e,{hash:{},data:t}):(i=e.subtitle,i=typeof i===a?i.apply(e):i),r+=f(i)+"</div>\n				",r}function x(e,t){var r="",i;r+='\n				<div class="links">\n					',i=n.each.call(e,e.links,{hash:{},inverse:l.noop,fn:l.program(24,T,t),data:t});if(i||i===0)r+=i;r+="\n					",i=n["if"].call(e,e.linksMetadata,{hash:{},inverse:l.noop,fn:l.program(27,C,t),data:t});if(i||i===0)r+=i;return r+="\n				</div>\n			",r}function T(e,t){var r="",i;r+="<span>",i=n["if"].call(e,e.url,{hash:{},inverse:l.noop,fn:l.program(25,N,t),data:t});if(i||i===0)r+=i;(i=n.text)?i=i.call(e,{hash:{},data:t}):(i=e.text,i=typeof i===a?i.apply(e):i);if(i||i===0)r+=i;i=n["if"].call(e,e.url,{hash:{},inverse:l.noop,fn:l.program(13,g,t),data:t});if(i||i===0)r+=i;return r+="</span>",r}function N(e,t){var r="",i;return r+='<a href="',(i=n.url)?i=i.call(e,{hash:{},data:t}):(i=e.url,i=typeof i===a?i.apply(e):i),r+=f(i)+'">',r}function C(e,t){var r="",i;return r+='<span class="links-metadata">',(i=n.linksMetadata)?i=i.call(e,{hash:{},data:t}):(i=e.linksMetadata,i=typeof i===a?i.apply(e):i),r+=f(i)+"</span>",r}function k(e,t){var r="",i;return r+='\n			<a href="',(i=n.link)?i=i.call(e,{hash:{},data:t}):(i=e.link,i=typeof i===a?i.apply(e):i),r+=f(i)+'" class="click-anywhere"></a>\n		',r}function L(e,t){var r="",i,s;r+='\n		<div class="button-content">\n			',s=n["if"].call(e,(i=e.cta,i==null||i===!1?i:i.staticButton),{hash:{},inverse:l.program(35,M,t),fn:l.program(32,A,t),data:t});if(s||s===0)r+=s;return r+="\n		</div>\n	",r}function A(e,t){var r="",i,s;r+='\n				<a class="butt join ',s=n["if"].call(e,(i=e.cta,i==null||i===!1?i:i.hasJoined),{hash:{},inverse:l.noop,fn:l.program(33,O,t),data:t});if(s||s===0)r+=s;return r+='" href="'+f((i=(i=(i=e.cta,i==null||i===!1?i:i.staticButton),i==null||i===!1?i:i.url),typeof i===a?i.apply(e):i))+'">'+f((i=(i=(i=e.cta,i==null||i===!1?i:i.staticButton),i==null||i===!1?i:i.text),typeof i===a?i.apply(e):i))+"</a>\n			",r}function O(e,t){return" has-joined "}function M(e,t){var r="",i,s;r+="\n				",s=n["if"].call(e,(i=e.cta,i==null||i===!1?i:i.joinPlaceholderId),{hash:{},inverse:l.program(38,D,t),fn:l.program(36,_,t),data:t});if(s||s===0)r+=s;return r+="\n			",r}function _(e,t){var n="",r;return n+='\n					\n					<span id="'+f((r=(r=e.cta,r==null||r===!1?r:r.joinPlaceholderId),typeof r===a?r.apply(e):r))+'"></span>\n				',n}function D(e,t){var r="",i,s;r+="\n					",s=n["if"].call(e,(i=e.cta,i==null||i===!1?i:i.followPlaceholderId),{hash:{},inverse:l.program(41,H,t),fn:l.program(39,P,t),data:t});if(s||s===0)r+=s;return r+="\n				",r}function P(e,t){var n="",r;return n+='\n					\n					<span id="'+f((r=(r=e.cta,r==null||r===!1?r:r.followPlaceholderId),typeof r===a?r.apply(e):r))+'"></span>\n					',n}function H(e,t){var r="",i,s;r+="\n						<button",s=n["if"].call(e,(i=e.avatar,i==null||i===!1?i:i.personNsid),{hash:{},inverse:l.noop,fn:l.program(11,m,t),data:t});if(s||s===0)r+=s;return r+=' class="'+f((i=(i=e.cta,i==null||i===!1?i:i.type),typeof i===a?i.apply(e):i))+' mini not-follow-view">'+f((i=(i=e.cta,i==null||i===!1?i:i.text),typeof i===a?i.apply(e):i))+"</button>\n					",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this;s+='<div class="result-card',o=n["if"].call(t,t.link,{hash:{},inverse:l.noop,fn:l.program(1,c,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,t.globalNavRestyleFlipped,{hash:{},inverse:l.noop,fn:l.program(3,h,i),data:i});if(o||o===0)s+=o;s+='">\n	',o=n["if"].call(t,t.coverPhotoUrl,{hash:{},inverse:l.noop,fn:l.program(5,p,i),data:i});if(o||o===0)s+=o;s+='\n	<div class="sizer-cropper" title="'+f((o=(o=t.title,o==null||o===!1?o:o.text),typeof o===a?o.apply(t):o))+'">\n		<div class="avatar-content">\n			',u=n["if"].call(t,(o=t.avatar,o==null||o===!1?o:o.link),{hash:{},inverse:l.noop,fn:l.program(7,d,i),data:i});if(u||u===0)s+=u;s+="\n				<div",u=n["if"].call(t,(o=t.avatar,o==null||o===!1?o:o.groupNsid),{hash:{},inverse:l.noop,fn:l.program(9,v,i),data:i});if(u||u===0)s+=u;u=n["if"].call(t,(o=t.avatar,o==null||o===!1?o:o.personNsid),{hash:{},inverse:l.noop,fn:l.program(11,m,i),data:i});if(u||u===0)s+=u;s+=' class="'+f((o=(o=t.avatar,o==null||o===!1?o:o.noMenu),typeof o===a?o.apply(t):o))+" avatar "+f((o=(o=t.avatar,o==null||o===!1?o:o.type),typeof o===a?o.apply(t):o))+' medium" title="'+
f((o=(o=t.avatar,o==null||o===!1?o:o.title),typeof o===a?o.apply(t):o))+'" style="background-image: url('+f((o=(o=t.avatar,o==null||o===!1?o:o.url),typeof o===a?o.apply(t):o))+');"></div>\n			',u=n["if"].call(t,(o=t.avatar,o==null||o===!1?o:o.link),{hash:{},inverse:l.noop,fn:l.program(13,g,i),data:i});if(u||u===0)s+=u;s+='\n		</div>\n		<div class="text-content">\n			<div class="title">'+f((o=(o=t.title,o==null||o===!1?o:o.text),typeof o===a?o.apply(t):o))+"</div>\n			",u=n["if"].call(t,t.subtitles,{hash:{},inverse:l.noop,fn:l.program(15,y,i),data:i});if(u||u===0)s+=u;s+="\n			",u=n.unless.call(t,t.subtitles,{hash:{},inverse:l.noop,fn:l.program(20,E,i),data:i});if(u||u===0)s+=u;s+="\n			",u=n["if"].call(t,t.links,{hash:{},inverse:l.noop,fn:l.program(23,x,i),data:i});if(u||u===0)s+=u;s+="\n		</div>\n		",u=n["if"].call(t,t.link,{hash:{},inverse:l.noop,fn:l.program(29,k,i),data:i});if(u||u===0)s+=u;s+="\n	</div>\n	",u=n["if"].call(t,t.cta,{hash:{},inverse:l.noop,fn:l.program(31,L,i),data:i});if(u||u===0)s+=u;return s+="\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/result-card",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-search-people-results-view",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){return"fluid-centered"}function h(e,t){return"centered-content"}function p(e,t){return'\n		<div style="position: absolute; top: 150px; left: 0; right: 0;"><div class="flickr-dots small"></div></div>\n	'}function d(e,t){var r="",i;r+="\n		",i=n["if"].call(e,e.validResults,{hash:{},inverse:u.program(18,E,t),fn:u.program(8,v,t),data:t});if(i||i===0)r+=i;return r+="\n	",r}function v(e,t){var r="",i,s,o;r+='\n			<div class="my-people hidden">\n				<h5>',o={hash:{intlName:"search.PEOPLE_YOU_FOLLOW"},data:t},r+=f((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'</h5>\n				<div id="people-results-my">\n					',s=n.each.call(e,(i=e.results,i==null||i===!1?i:i.myPeople),{hash:{},inverse:u.noop,fn:u.program(9,m,t),data:t});if(s||s===0)r+=s;r+='\n				</div>\n			</div>\n			<div class="all-people hidden">\n				<h5>',s=n["if"].call(e,e.scopedSearchTitle,{hash:{},inverse:u.program(13,y,t),fn:u.program(11,g,t),data:t});if(s||s===0)r+=s;r+='</h5>\n				<div id="people-results-all" class="all-people">\n					',s=n.each.call(e,(i=e.results,i==null||i===!1?i:i.allPeople),{hash:{},inverse:u.noop,fn:u.program(9,m,t),data:t});if(s||s===0)r+=s;return r+="\n				</div>\n			</div>\n		",r}function m(e,t){var i="",s;i+="\n						",s=u.invokePartial(r["result-card"],"result-card",e,n,r,t);if(s||s===0)i+=s;return i+="\n					",i}function g(e,t){var r;return(r=n.scopedSearchTitle)?r=r.call(e,{hash:{},data:t}):(r=e.scopedSearchTitle,r=typeof r===a?r.apply(e):r),f(r)}function y(e,t){var r;return r=n["if"].call(e,e.haveContacts,{hash:{},inverse:u.program(16,w,t),fn:u.program(14,b,t),data:t}),r||r===0?r:""}function b(e,t){var r,i;return i={hash:{intlName:"search.ALL_FLICKR_MEMBERS"},data:t},f((r=n.intlMessage||e.intlMessage,r?r.call(e,i):l.call(e,"intlMessage",i)))}function w(e,t){var r,i;return i={hash:{intlName:"search.FLICKR_MEMBERS"},data:t},f((r=n.intlMessage||e.intlMessage,r?r.call(e,i):l.call(e,"intlMessage",i)))}function E(e,t){var r="",i,s;return r+="\n			",s={hash:{},data:t},r+=f((i=n.outlet||e.outlet,i?i.call(e,e["search-empty-view"],s):l.call(e,"outlet",e["search-empty-view"],s)))+"\n		",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=this.merge(r,e.partials),i=i||{};var s="",o,u=this,a="function",f=this.escapeExpression,l=n.helperMissing;s+='<div class="main full-bleed ',o=n["if"].call(t,t.globalNavRestyleFlipped,{hash:{},inverse:u.program(3,h,i),fn:u.program(1,c,i),data:i});if(o||o===0)s+=o;s+='" role="main">\n	',o=n["if"].call(t,t.loading,{hash:{},inverse:u.program(7,d,i),fn:u.program(5,p,i),data:i});if(o||o===0)s+=o;return s+="\n</div>\n",s}),r={};e.Array.each(["result-card","result-card"],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-people-results-view",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-result-card","hermes-template-result-card"]});
YUI.add("hermes-template-result-cards",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function a(e,t){var i="",s;i+="\n	",s=u.invokePartial(r["result-card"],"result-card",e,n,r,t);if(s||s===0)i+=s;return i+="\n",i}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=this.merge(r,e.partials),i=i||{};var s="",o,u=this;o=n.each.call(t,t.results,{hash:{},inverse:u.noop,fn:u.program(1,a,i),data:i});if(o||o===0)s+=o;return s+="\n",s}),r={};e.Array.each(["result-card"],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/result-cards",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-result-card"]});
YUI.add("collection-paginator",function(e){var t=100,n=e.CollectionPaginator=function(e,n,r){r&&r.page?this.page=this.startPage=r.page-1:this.page=this.startPage=0,r&&r.fetchPageSize?this.perPage=r.fetchPageSize:this.perPage=t,r&&r.viewPageSize?this.viewPageSize=r.viewPageSize:this.viewPageSize=Number.MAX_VALUE,this.lastPage=this.startPage+Math.ceil(this.viewPageSize/this.perPage),this.modelProxy=e,this.listAttr=n,this.prepending=!1,this._advanceToFirstIncompletePage(),this.valuesChangedHandle=this.modelProxy.on("valuesChanged",this._onValuesChanged.bind(this),!0)};n.prototype={passAttributesToFetcher:function(e){this.fetcherParamAttrs=e instanceof Array?e:[e]},next:function(e){return this.page<this.lastPage&&this.page++,this._getPage()},prev:function(e){return this.page>0&&this.page--,this._getPage()},getCollectionAsList:function(){return this.modelProxy.getValue(this.listAttr).getList()},getCurrentPageAsList:function(){var t=this.modelProxy.getValue(this.listAttr).getList(),n=this.startPage*this.perPage,r=n+this.viewPageSize;if(!n||isNaN(n))throw new Error("Unexpected page parameters in collection-paginator");return t=t.slice(n,r),t.length&&(t=e.FlickrCollection.trimArray(t)),t},currentPageIsLoaded:function(){return this.getCurrentPageAsList().length===this.viewPageSize||this.modelProxy.getValue(this.listAttr).fetchedEnd},_getPage:function(){var e={},t=this.modelProxy.getValue(this.listAttr).getList(),n=(this.page-1)*this.perPage,r=this.page*this.perPage,i=this.startPage*this.perPage+this.viewPageSize,s=!1,o,u=this;if(this.viewPageSize<1e3&&this.page&&this.perPage){for(o=r+1;o<i;o++)if(typeof t[o]!="undefined"){s=!0;break}if(s)for(o=n;o<r;o++)if(typeof t[o]=="undefined"){this.prepending=!0;break}}return this.page&&(e.page=this.page),this.perPage&&(e.perPage=this.perPage),this.fetcherParamAttrs&&this.fetcherParamAttrs.forEach(function(t){e[t]=u.modelProxy.getValue(t)}),this.modelProxy.getValue(this.listAttr).getPage(e)},_onValuesChanged:function(e){var t;e[this.listAttr]&&e[this.listAttr].listDiff&&(t=e[this.listAttr].listDiff,this.prepending&&(this.prepending=!1,t.prepended=t.added),this.fire("listValueChanged",t))},_advanceToFirstIncompletePage:function(){var e=this.modelProxy.getValue(this.listAttr).getList(),t;if(this.viewPageSize===Number.MAX_VALUE)this.page=Math.floor(this.getCollectionAsList().length/this.perPage);else while(this.page<this.lastPage){t=e.slice(this.page*this.perPage,(this.page+1)*this.perPage);if(!(t.length>=this.perPage&&t.every(function(e){return typeof e!="undefined"})))break;this.page++}}},e.augment(n,e.EventTarget)},"@VERSION@",{requires:["event-custom","flickr-collection"]});
YUI.add("search-people-results-view",function(e){"use strict";var t=5;e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,stillLoadingResults:!1,initializer:function(t){var n;return this.get("container").get("innerHTML")===""&&(n=this.templates("search-people-results-view")({loading:!0}),this.setContainerHTML(n)),this.searchParams=t.searchParams||{},this.searchParams.all?this.apiParams=e.merge(this.searchParams.all.apiParams):this.apiParams={},this.searchUrl=new e.SearchUrl(this.apiParams,this.appContext,e.SearchUrl.searchTypes.PEOPLE),this.apiFailed=t.apiFailed,this.searchTerm=t.searchTerm,this.allResults={collectionModel:null,paginator:null,renderedPages:[]},this.contactsResults={collectionModel:null,paginator:null,renderedPages:[]},this.scrollInterruptParams={pageCounts:[5],footerToHideWhileScrolling:".footer-full-view"},this.scrollInterruptState={nextInterrupt:this.scrollInterruptParams.pageCounts[0],numPagesLoaded:0,numInterrupts:0,isInterrupted:!1,footer:null,footerHeight:0},this},subviewConfig:{"search-empty-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},loadState:function(){var t=this,n={},r=["username","userId","loadFullContact"],i=["username","loadFullContact"];return YUI.Env.isServer||this.apiFailed||!this.searchParams?e.Promise.resolve():(this.searchParams.all&&(n.all=this.appContext.getModel("search-contacts-models",this.searchParams.all.id,this.searchParams.all.apiParams),this.searchParams.all.apiParams&&this.searchParams.all.apiParams[e.SearchHelper.PEOPLE_SEARCH_API.userId]&&(i.push("userId"),n.allTitle=e.SearchHelper.derivePeopleScopeTitle(this.searchParams.all.apiParams,this.appContext))),this.searchParams.contacts&&(n.contacts=this.appContext.getModel("search-contacts-models",this.searchParams.contacts.id,this.searchParams.contacts.apiParams)),e.FlickrPromise(n).then(function(n){n.all&&n.all.getValue("contacts").size()?(t.validResults=!0,t.allResults.collectionModel=n.all,t.allResults.paginator=new e.CollectionPaginator(t.allResults.collectionModel,"contacts",{fetchPageSize:t.searchParams.all.apiParams.perPage}),t.allResults.paginator.page=Math.ceil(n.all.getValue("contacts").size()/t.searchParams.all.apiParams.perPage),t.allResults.paginator.passAttributesToFetcher(i),n.allTitle&&(t.scopedSearchTitle=t.intlMessage(n.allTitle))):n.all&&(t.subviews["search-empty-view"].set("noMatchesForQuery",t.buildNoMatchesFoundMessage()),t.subviews["search-empty-view"].fire("parentViewEvent","error-msg-updated")),n.contacts&&n.contacts.getValue("contacts").size()&&(t.haveContacts=!0,t.contactsResults.collectionModel=n.contacts,t.contactsResults.paginator=new e.CollectionPaginator(t.contactsResults.collectionModel,"contacts",{fetchPageSize:t.searchParams.contacts.apiParams.perPage}),t.contactsResults.paginator.page=Math.ceil(n.contacts.getValue("contacts").size()/t.searchParams.contacts.apiParams.perPage),t.contactsResults.paginator.passAttributesToFetcher(r))}))},buildContainer:function(){return this.setContainerHTML(this.templates("search-people-results-view")({results:{myPeople:[],allPeople:[]},validResults:this.validResults,haveContacts:this.haveContacts,scopedSearchTitle:this.scopedSearchTitle,globalNavRestyleFlipped:this.appContext.flipper.isFlipped("global-nav-restyle"),"search-empty-view":this.subviews["search-empty-view"].get("container")})),!YUI.Env.isServer&&this.validResults&&(this.contactsResults.collectionModel&&this.renderContacts(this.contactsResults.collectionModel.getValue("contacts").getList(),!0),this.renderContacts(this.allResults.collectionModel.getValue("contacts").getList(),!1)),this},activate:function(){return this.registerEventHandler(e.globalEvents.subscribe("window:scroll",this.handleScroll.bind(this))),this},buildNoMatchesFoundMessage:function(){var t,n;return this.searchTerm?n="search.NO_MATCHES_FOR_QUERY_TERM_WITH_SETTINGS":n="search.NO_MATCHES_FOR_QUERY",this.searchTerm?t=this.intlMessage({intlName:n,searchTerm:e.flutil.unescape(this.searchTerm)}):t=this.intlMessage({intlName:n}),{noMatchesText:t}},loadNextPage:function(t){var n=t?this.contactsResults:this.allResults,r,i=this;this.scrollInterruptState.footer||(this.scrollInterruptState.footer=e.one(this.scrollInterruptParams.footerToHideWhileScrolling),this.scrollInterruptState.footer&&(this.scrollInterruptState.footerHeight=this.scrollInterruptState.footer.get("clientHeight"),this.scrollInterruptState.footer.addClass("infinite-scroll-hide-footer")));if(!n||!n.paginator)return;r=n.collectionModel?n.collectionModel.getValue("contacts"):null;if(r.fetchedEnd&&n.paginator.page>=r.totalPages)return;return this.stillLoadingResults=!0,this.get("showThrobberDuringLoad")&&this.toggleThrobber(!0),n.paginator.next().then(function(e){i.stillLoadingResults=!1,i.get("showThrobberDuringLoad")&&i.toggleThrobber(!1),e&&(i.renderContacts(e,t),!t&&!r.fetchedEnd&&(i.scrollInterruptState.numPagesLoaded++,i.checkScrollInterruptionState(),i.handleScroll(null))),r.fetchedEnd&&i.scrollInterruptState.footer.removeClass("infinite-scroll-hide-footer")}.bind(this)).catch(e.PromiseCatcher(i.name))},renderContacts:function(t,n){var r=[],i,s=this.get("container"),o=this;return e.Array.each(t,function(t){if(!t)return;var n={isPro:o.appContext.flipper.isFlipped("enable-pro-badge")?t.getValue("isPro"):!1,link:t.getValue("profileURL"),avatar:{type:"person",title:t.getValue("username"),url:t.getValue("buddyicon"),personNsid:t.getValue("nsid")},title:{text:t.getValue("realname")||t.getValue("username")},subtitles:[t.getValue("username")||""],links:[],linksMetadata:o.intlMessage({intlName:"search.JOINED_DATE",intlDate:t.getValue("dateJoined").toDate()}),cta:{followPlaceholderId:"follow"+t.getValue("nsid").replace("@","")}},i=e.flutil.formatNumbers(t.getValue("photosCount")),u=e.flutil.formatNumbers(t.getValue("followersCount"));t.getValue("photosCount")&&n.links.push({url:t.getValue("profileURL"),text:'<i class="photos-icon"></i>'+i}),t.getValue("followersCount")&&n.links.push({url:t.getValue("profileURL"
),text:'<i class="members-icon"></i>'+u}),o.instantiateSubview("follow-view",{nsid:t.getValue("nsid"),pathAlias:t.getValue("pathAlias"),isFluid:!0}).then(function(e){return e.initialize()}).then(function(e){s.one("#"+n.cta.followPlaceholderId).replace(e.get("container")),e.normalizedActivate()}),n.globalNavRestyleFlipped=o.appContext.flipper.isFlipped("global-nav-restyle"),r.push(n)}),i=this.templates("result-cards")({results:r}),n?(this.contactsResults.renderedPages.push(i),t.length>0&&(s.one("#people-results-my").append(i),s.one(".my-people").removeClass("hidden"))):(this.allResults.renderedPages.push(i),t.length>0&&(s.one("#people-results-all").append(i),s.one(".all-people").removeClass("hidden"))),i},handleScroll:function(n){if(this.allResults.collectionModel&&this.allResults.collectionModel.getValue("contacts").fetchedEnd||this.scrollInterruptState.isInterrupted)return;var r=this.get("container"),i=this.appContext.viewportData.getHeight(),s=r.get("clientHeight"),o=e.config.win.pageYOffset,u=r.getY()+s,a=o+i;!this.stillLoadingResults&&u-a<t*i&&this.loadNextPage()},checkScrollInterruptionState:function(e){if(!this.scrollInterruptState&&!e)return;var t;if(this.scrollInterruptState.numPagesLoaded>=this.scrollInterruptState.nextInterrupt){this.scrollInterruptState.numInterrupts++,t=this.scrollInterruptParams.pageCounts[this.scrollInterruptParams.pageCounts.length-1];if(this.scrollInterruptState.numInterrupts>=this.scrollInterruptParams.pageCounts.length)switch(this.scrollInterruptParams.repeatMode){case"exponential":this.scrollInterruptState.nextInterrupt+=t*Math.pow(2,this.scrollInterruptState.numInterrupts-this.scrollInterruptParams.pageCounts.length);break;case"linear":default:this.scrollInterruptState.nextInterrupt+=t}else this.scrollInterruptState.nextInterrupt+=this.scrollInterruptParams.pageCounts[this.scrollInterruptState.numInterrupts];e||this.interruptScroll()}},interruptScroll:function(){if(this.scrollInterruptState.isInterrupted)return;this.scrollInterruptState.isInterrupted=!0,this.scrollInterruptState.loadMoreElement||(this.scrollInterruptState.loadMoreElement=e.Node.create(this.templates("infinite-scroll-load-more")({}))),this.get("container").append(this.scrollInterruptState.loadMoreElement),this.scrollInterruptState.loadMoreElementHeight||(this.scrollInterruptState.loadMoreElementHeight=this.scrollInterruptState.loadMoreElement.get("clientHeight"),this.registerEventHandler(this.scrollInterruptState.loadMoreElement.on("click",this.onLoadMoreClicked.bind(this)))),this.scrollInterruptState.footer&&this.scrollInterruptState.footer.removeClass("infinite-scroll-hide-footer")},onLoadMoreClicked:function(e){if(!this.scrollInterruptState.isInterrupted)return;this.scrollInterruptState.isInterrupted=!1,this.scrollInterruptState.loadMoreElement.remove(),this.scrollInterruptState.footer&&this.scrollInterruptState.footer.addClass("infinite-scroll-hide-footer"),this.loadNextPage()},toggleThrobber:function(e){var t=this.get("container");e===undefined&&(e=!this.get("isThrobberShowing")),e?this.get("throbberNode").appendTo(t):this.get("throbberNode").remove(),this._set("isThrobberShowing",e)}},{ATTRS:{showThrobberDuringLoad:{value:!0,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)}},isThrobberShowing:{readOnly:!0,value:!1},throbberNode:{readOnly:!0,getter:function(t){return!YUI.Env.isServer&&t===undefined&&(t=e.Node.create('<div style="position: absolute; bottom: 50px; left: 0; right: 0;"><div class="flickr-dots small"></div></div>'),this._set("throbberNode",t)),t}}}})},"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","search-url","hermes-template-search-people-results-view","hermes-template-infinite-scroll-load-more","infinite-scroll-load-more-css","result-card-css","hermes-template-result-card","hermes-template-result-cards","collection-paginator","follow-view","search-empty-view"],langBundles:["search","common"]});
YUI.add("search-people-page-view",function(e){var t=e.url("/help/forum/en-us/72157651248603362/lastpage#reply"),n="search-people-feedback";e.namespace("Views")[this.name]=e.Base.create("search-people-page-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this.apiFailed=e.apiFailed,this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"search-subnav-slender-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"search-people-results-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1},"feedback-widget-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,feedbackUrl:t,trackingSlk:n,hidden:!0},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},loadState:function(){return e.Promise.resolve()},buildContainer:function(){var e;return e={"global-nav-view":this.subviews["global-nav-view"].get("container"),"search-people-results-view":this.subviews["search-people-results-view"].get("container"),"search-subnav-view":this.subviews["search-subnav-slender-view"].get("container"),"feedback-widget-view":this.subviews["feedback-widget-view"].get("container"),"footer-full-view":this.subviews["footer-full-view"].get("container")},this.setContainerHTML(this.templates("search-people-page")(e)),this},activate:function(){return this.fire("parentViewEvent","unhideFeedbackWidget"),this}},{ATTRS:{spaceid:{value:792600564}}})},"@VERSION@",{requires:["url","flickr-view","flickr-promise","global-nav-view","feedback-widget-view","footer-full-view","search-helper","hermes-template-search-people-page","search-people-css","search-subnav-slender-view","search-people-results-view"],langBundles:["search"]});
YUI.add("search-people-route",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Routes[this.name]=t,e.extend(t,e.FlickrRoute,{langBundles:this.details.langBundles,run:function(t){var n={},r=this,i,s={};return n.apiParams=this.processRequest(t),n.viewerNsid=t.probableUser||this.appContext.getViewer().nsid,i=this.generateSearchParams(n),i.all&&(s.all=this.appContext.getModel("search-contacts-models",i.all.id,i.all.apiParams)),i.contacts&&(s.contacts=this.appContext.getModel("search-contacts-models",i.contacts.id,i.contacts.apiParams)),e.FlickrPromise(s).then(function(t){var s=n.apiParams&&n.apiParams.username,o=r.intlMessage({intlName:"search.SEARCH"});return s!==undefined&&(o+=": "+s),e.Promise.resolve({title:o,view:"search-people-page-view",layout:"scrolling",fluid:!0,params:{searchParams:i,searchType:e.SearchUrl.searchTypes.PEOPLE,modelParams:n,searchTerm:s}})},function(t){e.Flog.warn("search-people-route",t.message);var i=n.apiParams&&n.apiParams.username,s=r.intlMessage({intlName:"search.SEARCH"});return i!==undefined&&(s+=": "+i),e.Promise.resolve({title:s,view:"search-people-page-view",params:{searchTerm:i,apiFailed:!0},fluid:!0})})},generateSearchParams:function(t){var n={},r=t.apiParams||{},i;return e.SearchHelper.isParameterlessSearch(r)?n:(this.shouldPerformAllPeopleSearch(t,r)&&(i=new e.SearchUrl(r,this.appContext,e.SearchUrl.searchTypes.PEOPLE),n.all={id:i.getId(),apiParams:e.merge(i.getAPIParams(),{perPage:50})}),this.shouldPerformContactsSearch(t,r)&&(i=new e.SearchUrl(e.merge(r,{user_id:t.viewerNsid}),this.appContext,e.SearchUrl.searchTypes.PEOPLE),n.contacts={id:i.getId(),apiParams:e.merge(i.getAPIParams(),{perPage:200})}),n)},shouldPerformAllPeopleSearch:function(t,n){return!!n[e.SearchHelper.PEOPLE_SEARCH_API.username]},shouldPerformContactsSearch:function(t,n){return n[e.SearchHelper.PEOPLE_SEARCH_API.username]&&t.viewerNsid&&!n[e.SearchHelper.PEOPLE_SEARCH_API.userId]},processRequest:function(t){var n=null;return n=e.SearchHelper.mapClassicPeopleSearchToAPI(t.query,this.appContext),t.query.text&&(n.username=t.query.text),e.SearchHelper.addPeopleParamDefaults(n),YUI.Env.isServer&&e.SearchHelper.unescapeParameters(n),n}}),e.mix(t.prototype,e.Localizable)},"@VERSION@",{requires:["flickr-route","flickr-promise","search-helper","querystring-stringify-simple","localizable","url","search-url","search-people-page-view"],langBundles:["search"]});
